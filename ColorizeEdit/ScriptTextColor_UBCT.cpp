// ScriptTextColor_UBCT.cpp: implementation of the CScriptTextColor_UBCT class.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "ScriptTextColor_UBCT.h"


#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[]=__FILE__;
#define new DEBUG_NEW
#endif

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////
const S_KEYWORD_COLOR_INFO G_DEFAULT_KEYWORD [] = 
{
	S_KEYWORD_COLOR_INFO("LOCAL"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("DISP"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("ADD"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("SUB"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("MUL"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("DIV"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("MOD"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("PARSETLV"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("LEFT"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("RIGHT"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("MID"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("LEN"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("EXLEN"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("APPEND"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("ADDS"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("SUBS"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("MAKELV"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("SLEN"						, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("EXSLEN"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("MAKETLV"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("FINDTLV"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("CIPHER"					, RGB(0,0,255) ), 
	S_KEYWORD_COLOR_INFO("SET"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("JMP"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("JNE"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SENDAPDU"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("POWERON"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("CLNG"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("CSTR"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("AND"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("OR"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("XOR"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("NOT"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("JL"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("JE"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("JG"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("JLE"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("JGE"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("RSA"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SM2"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SM2SIGN"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SM2GETPUBK"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SM2VERIFY"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SM3"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SM3_HMAC"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SM4"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("CRC16"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("HASH"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("PADDING"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("RANDOM"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SETCHANNEL"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SETAUTOPROCESS"			, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("POWEROFF"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("LOAD"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SENDAPDUTEAR"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPSETCAP"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPGETLFDB"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPGETELFAID"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPGETEMAID"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPSETDESKEY"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPSETDAPKEY"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPWRAP"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPENCRYPTKEYANDKCV"		, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPGETDK"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPSELECT"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPMUTUALAUTH"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPDELETE"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPGETDATA"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPGETSTATUS"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPINSTALLFORLOAD"			, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPINSTALLFORINSTALL"		, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPINSTALLFOREXTRADITION"	, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPLOAD"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPSETSTATUS"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPSTOREDATA"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SET"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("CALL"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("COUNTER"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("DISP"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("TIME"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("COMPARE"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("EXITSCRIPT"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("OPEN"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("MILENAGE"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("HMAC"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("PRF"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("CASCII"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("IF"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("ELSE"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("ENDIF"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("ANDb"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("ORb"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("XORb"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("NOTb"						, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("CNVTNUM"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GETRESPONSE"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SAMECOMMAND"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("PADDING16"				, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GLOBAL"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("SHIFT"					, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPPUTKEYFORDES"			, RGB(0,0,255) ),
	S_KEYWORD_COLOR_INFO("GPPUTKEYFORRSA"			, RGB(0,0,255) ),
	

	S_KEYWORD_COLOR_INFO("USERCARD"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("NUMERIC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("STRING"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SAMCARD"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ON"						, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("OFF"						, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("CPG201"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("CPG211"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("START"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("STOP"						, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("TEXT"						, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("BINARY"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("HEX_BIN"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("HEX_OCT"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("HEX_DEC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DEC_BIN"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DEC_OCT"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DEC_HEX"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("OCT_BIN"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("OCT_DEC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("OCT_HEX"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("BIN_OCT"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("BIN_DEC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("BIN_HEX"					, RGB(128,0,255) ),

	S_KEYWORD_COLOR_INFO("DES_ENC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DES_ENC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DES_DEC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DES_DEC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DES_MAC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("TDES_ENC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("TDES_ENC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("TDES_DEC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("TDES_DEC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("TDES_MAC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("DES_TDES_MAC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SEED_ENC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SEED_ENC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SEED_DEC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SEED_DEC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SEED_MAC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("FDES_ENC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("FDES_ENC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("FDES_DEC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("FDES_DEC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("FDES_MAC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES"						, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("RSA_ENC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("RSA_DEC"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("RSA_SIGN"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ALGO_SM2_SIGN"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ALGO_SM2_VERIFY"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ALGO_SM4_ENC_ECB"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ALGO_SM4_DEC_ECB"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ALGO_SM4_ENC_CBC"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ALGO_SM4_DEC_CBC"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SHA1"						, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("MD5"						, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("SHA256"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ISO9797_M1"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ISO9797_M2"			, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_PKCS5"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SEED"					, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_2048"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_1408"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_1152"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_1024"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_896"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_768"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_640"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_ENC_PKCS1_512"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_2048"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_1408"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_1152"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_1024"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_896"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_768"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_640"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("PAD_SIGN_PKCS1_512"		, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_ENC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_ENC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_ENC_MAC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_ENC_GCM"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_DEC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_DEC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_DEC_MAC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("AES_DEC_GCM"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ARIA_ENC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ARIA_ENC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ARIA_DEC_CBC"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ARIA_DEC_ECB"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ARIA_AE_GCM"				, RGB(128,0,255) ),
	S_KEYWORD_COLOR_INFO("ARIA_AD_GCM"				, RGB(128,0,255) ),
};

CScriptTextColor_UBCT::CScriptTextColor_UBCT()
{

}

CScriptTextColor_UBCT::~CScriptTextColor_UBCT()
{
	clear();
}

void	CScriptTextColor_UBCT::Release					()
{
	delete this;
}

void	CScriptTextColor_UBCT::LoadDefaultStyle			()
{
	int i;
	int nCount = sizeof(G_DEFAULT_KEYWORD)/ sizeof(S_KEYWORD_COLOR_INFO);
	clear();
	for( i=0 ; i<nCount ; i++ )
	{
		insert( PairColorTable( G_DEFAULT_KEYWORD[i].szKeyWord, G_DEFAULT_KEYWORD[i]) );
	}
}

S_KEYWORD_COLOR_INFO* CScriptTextColor_UBCT::GetKeywordColor		( const CString& strKeyword )
{
	MapColorTable::iterator it;

	it = find( strKeyword );
	if( it == end() )
		return NULL;
	return &it->second;
}
